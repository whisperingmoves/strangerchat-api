openapi: 3.0.0
info:
  title: 陌生人聊天交友App
  version: 1.0.0
tags:
  - name: 验证码
    description: 验证码相关接口
  - name: 用户
    description: 用户相关接口
  - name: 资源
    description: 资源相关接口
  - name: 故事
    description: 故事相关接口
  - name: 帖子
    description: 帖子相关接口
  - name: 评论
    description: 评论相关接口
  - name: 通知
    description: 通知相关接口
  - name: 礼物
    description: 礼物相关接口
  - name: 商品
    description: 商品相关接口
  - name: 交易记录
    description: 交易记录相关接口
  - name: WebSocket
    description: WebSocket相关接口
  - name: Bundle
    description: Bundle相关接口
  - name: 监控
    description: 监控相关接口
  - name: 后台管理
    description: 后台管理相关接口
  - name: 语音通话记录
    description: 语音通话记录相关接口
paths:

  /verifications/sendCode:
    post:
      summary: 发送验证码
      tags:
        - 验证码
      security: [ ]
      requestBody:
        content:
          application/json:
            schema:
              required:
                - mobile
              properties:
                mobile:
                  type: string
                  description: 手机号码
      responses:
        200:
          description: 发送成功
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /verifications/verifyCode:
    post:
      summary: 验证码验证
      tags:
        - 验证码
      security: [ ]
      requestBody:
        content:
          application/json:
            schema:
              required:
                - mobile
                - code
              properties:
                mobile:
                  type: string
                  description: 手机号码
                code:
                  type: string
                  description: 验证码
                longitude:
                  type: string
                  format: float
                  description: 经度
                latitude:
                  type: string
                  format: float
                  description: 纬度
      responses:
        200:
          description: 验证成功并且手机号已注册,返回登录jwt和用户信息
          content:
            application/json:
              schema:
                required:
                  - token
                  - userId
                  - gender
                  - birthday
                  - avatar
                properties:
                  token:
                    type: string
                    description: 登录jwt
                  userId:
                    type: string
                    description: 用户ID
                  gender:
                    type: string
                    description: 性别
                  birthday:
                    type: string
                    format: date
                    description: 生日
                  avatar:
                    type: string
                    description: 头像URL
                  giftsReceived:
                    type: integer
                    description: 收到的礼物数
                  username:
                    type: string
                    description: 用户名
                  city:
                    type: string
                    description: 所在城市名称
                  followingCount:
                    type: integer
                    description: 我关注的用户数
                  followersCount:
                    type: integer
                    description: 关注我的用户数
                  visitorsCount:
                    type: integer
                    description: 我的访客数
                  freeHeatsLeft:
                    type: integer
                    description: 免费加热次数
                  coinBalance:
                    type: integer
                    description: 金币余额
                  checkedDays:
                    type: integer
                    format: int32
                    minimum: 0
                    maximum: 7
                    description: 连续签到的天数
                    example: 4
                    default: 0
                  lastCheckDate:
                    type: integer
                    format: unix timestamp
                    description: 上次签到的日期
                    example: 1578518245
        201:
          description: 验证成功但是手机号未注册,需要进入注册流程
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/register:
    post:
      summary: 用户注册
      tags:
        - 用户
      security: [ ]
      requestBody:
        content:
          application/json:
            schema:
              required:
                - mobile
                - gender
                - birthday
                - avatar
              properties:
                mobile:
                  type: string
                  description: 手机号码
                gender:
                  type: string
                  description: 性别
                birthday:
                  type: string
                  format: date
                  description: 生日
                avatar:
                  type: string
                  description: 头像
                longitude:
                  type: string
                  format: float
                  description: 经度
                latitude:
                  type: string
                  format: float
                  description: 纬度
      responses:
        200:
          description: 注册成功
          content:
            application/json:
              schema:
                required:
                  - token
                  - userId
                properties:
                  token:
                    type: string
                    description: 登录jwt
                  userId:
                    type: string
                    description: 用户ID
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /uploadAvatar:
    post:
      summary: 上传头像
      tags:
        - 资源
      security:
        - JWTAuth: [ upload ]
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - avatar
              properties:
                avatar:
                  type: string
                  format: binary
                  description: 头像图片
            encoding:
              avatar:
                contentType: image/*
      responses:
        200:
          description: 上传成功
          content:
            application/json:
              schema:
                required:
                  - url
                properties:
                  url:
                    type: string
                    description: 头像URL
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /stories:
    get:
      summary: 获取故事列表
      description: 获取发表过帖子的用户列表，按创建时间排序，分页展示
      tags:
        - 故事
      parameters:
        - name: page
          in: query
          description: 页码
          required: false
          schema:
            type: integer
            format: int32
            minimum: 1
            default: 1
        - name: pageSize
          in: query
          description: 每页大小
          required: false
          schema:
            type: integer
            format: int32
            minimum: 1
            maximum: 100
            default: 10
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - userId
                    - avatar
                    - createTime
                  properties:
                    userId:
                      type: string
                      description: 用户ID
                    avatar:
                      type: string
                      description: 用户头像URL，半截URL，如：/uploads/xxx.png
                    username:
                      type: string
                      description: 用户名
                    createTime:
                      type: integer
                      format: int64
                      description: 最新帖子创建时间（精确到秒的Unix时间戳）
                    relation:
                      type: integer
                      enum:
                        - 0
                        - 1
                        - 2
                        - 3
                      description: |
                        与登录用户关系
                        0 - 互相关注
                        1 - 对方关注了我
                        2 - 我关注了对方
                        3 - 新用户
                      example: 0
                    firstImage:
                      type: string
                      description: 最新帖子第一张图片
                    online:
                      type: integer
                      enum:
                        - 0
                        - 1
                      description: 是否在线:0=否,1=是
                      default: 0
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/follows:
    get:
      summary: 获取我关注用户的帖子列表
      description: 获取我关注用户发布的帖子列表，按发布时间排序，支持分页
      tags:
        - 帖子
      parameters:
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            format: int32
            default: 1
            minimum: 1
        - name: pageSize
          in: query
          description: 每页大小
          schema:
            type: integer
            format: int32
            default: 10
            minimum: 1
            maximum: 100
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - authorId
                    - authorAvatar
                    - createTime
                    - content
                    - postId
                  properties:
                    authorId:
                      type: string
                      description: 作者用户ID
                    authorAvatar:
                      type: string
                      description: 作者头像
                    authorName:
                      type: string
                      description: 作者用户名
                    createTime:
                      type: integer
                      format: int64
                      description: 创建时间（精确到秒的Unix时间戳）
                    images:
                      type: array
                      maxItems: 9
                      items:
                        type: string
                        description: 照片URL
                    content:
                      type: string
                      description: 文字内容
                    city:
                      type: string
                      description: 发帖位置
                    likeCount:
                      type: integer
                      default: 0
                      description: 点赞数
                    commentCount:
                      type: integer
                      default: 0
                      description: 评论数
                    postId:
                      type: string
                      description: 帖子ID
                    isLiked:
                      type: integer
                      enum:
                        - 0
                        - 1
                      description: 是否已点赞（非必填字段，默认为0，0表示否，1表示是）
                      example: 1
                      default: 0
                    conversationId:
                      type: string
                      description: 聊天会话的ID
                      example: "6133a6e2f7dcb80021a7e28a"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/recommended:
    get:
      summary: 获取推荐帖子列表
      description: 获取推荐帖子列表，按距离排序，支持分页
      tags:
        - 帖子
      parameters:
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: pageSize
          in: query
          description: 每页大小
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: longitude
          in: query
          description: 经度
          schema:
            type: number
            format: float
        - name: latitude
          in: query
          description: 纬度
          schema:
            type: number
            format: float
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - authorId
                    - authorAvatar
                    - content
                    - postId
                  properties:
                    authorId:
                      type: string
                      description: 作者用户ID
                      example: "user1"
                    authorAvatar:
                      type: string
                      description: 作者头像（半截URL，如/uploads/xxx.png）
                      example: "/uploads/avatar.png"
                    authorName:
                      type: string
                      description: 作者用户名
                      example: "John123"
                    images:
                      type: array
                      maxItems: 9
                      items:
                        type: string
                        description: 照片URL（最多9张照片，每张照片为一个半截URL）
                        example:
                          - "/uploads/photo1.png"
                          - "/uploads/photo2.png"
                    content:
                      type: string
                      description: 文字内容
                      example: "这是一条帖子内容。"
                    city:
                      type: string
                      description: 发帖位置
                      example: "北京"
                    likeCount:
                      type: integer
                      default: 0
                      description: 点赞数
                      example: 10
                    commentCount:
                      type: integer
                      default: 0
                      description: 评论数
                      example: 5
                    postId:
                      type: string
                      description: 帖子ID
                      example: "123456"
                    isLiked:
                      type: integer
                      enum:
                        - 0
                        - 1
                      description: 是否已点赞（非必填字段，默认为0，0表示否，1表示是）
                      example: 1
                      default: 0
                    isFollowed:
                      type: integer
                      enum:
                        - 0
                        - 1
                      description: 是否已关注作者（非必填字段，默认为0，0表示否，1表示是）
                      example: 1
                      default: 0
                    conversationId:
                      type: string
                      description: 聊天会话的ID
                      example: "6133a6e2f7dcb80021a7e28a"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/latest:
    get:
      summary: 获取最新帖子列表
      description: 获取最新帖子列表，按发布时间排序，支持分页，支持内容模糊匹配
      tags:
        - 帖子
      parameters:
        - name: keyword
          in: query
          description: 匹配关键词
          schema:
            type: string
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: pageSize
          in: query
          description: 每页大小
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: filter
          in: query
          description: 筛选条件
          schema:
            type: integer
            description: 可使用以下值进行筛选:0=不应用任何筛选条件,1=返回我点赞过的帖子,2=返回我评论过的帖子,3=返回我收藏过的帖子
            enum: [ 0, 1, 2, 3 ]
            default: 0
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - authorId
                    - authorAvatar
                    - createTime
                    - content
                    - postId
                  properties:
                    authorId:
                      type: string
                      description: 作者用户ID
                      example: "user1"
                    authorAvatar:
                      type: string
                      description: 作者头像（半截URL，如/uploads/xxx.png）
                      example: "/uploads/avatar.png"
                    authorName:
                      type: string
                      description: 作者用户名（非必填字段）
                      example: "John123"
                    createTime:
                      type: integer
                      description: 创建时间（精确到秒的Unix时间戳）
                      example: 1627708878
                    images:
                      type: array
                      maxItems: 9
                      items:
                        type: string
                        description: 照片URL（最多9张照片，每张照片为一个半截URL）
                        example:
                          - "/uploads/photo1.png"
                          - "/uploads/photo2.png"
                    content:
                      type: string
                      description: 文字内容
                      example: "这是一条帖子内容。"
                    city:
                      type: string
                      description: 发帖位置（非必填字段）
                      example: "北京"
                    likeCount:
                      type: integer
                      default: 0
                      description: 点赞数（非必填字段，默认为0）
                      example: 10
                    commentCount:
                      type: integer
                      default: 0
                      description: 评论数（非必填字段，默认为0）
                      example: 5
                    postId:
                      type: string
                      description: 帖子ID
                      example: "123456"
                    isLiked:
                      type: integer
                      enum:
                        - 0
                        - 1
                      description: 是否已点赞（非必填字段，默认为0，0表示否，1表示是）
                      example: 1
                      default: 0
                    isFollowed:
                      type: integer
                      enum:
                        - 0
                        - 1
                      description: 是否已关注作者（非必填字段，默认为0，0表示否，1表示是）
                      example: 1
                      default: 0
                    conversationId:
                      type: string
                      description: 聊天会话的ID
                      example: "6133a6e2f7dcb80021a7e28a"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/hot:
    get:
      summary: 获取热度帖子列表
      description: 获取热度排名前7的帖子列表
      tags:
        - 帖子
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: array
                maxItems: 7
                items:
                  type: object
                  required:
                    - postId
                    - userId
                    - content
                  properties:
                    postId:
                      type: string
                      description: 帖子ID
                      example: "123456"
                    userId:
                      type: string
                      description: 用户ID
                      example: "user1"
                    username:
                      type: string
                      description: 作者用户名（非必填字段）
                      example: "John123"
                    content:
                      type: string
                      maxLength: 100
                      description: 帖子内容摘要（最多100个字符，多余的字符使用省略号代替）
                      example: "这是一条帖子内容摘要..."
                    hotIndex:
                      type: integer
                      default: 0
                      description: 热度指数（非必填字段，默认为0）
                      example: 10
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts:
    post:
      summary: 发布帖子
      tags:
        - 帖子
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  description: 帖子文字内容
                  example: "这是一条帖子内容。"
                city:
                  type: string
                  description: 帖子发表时所在城市名称
                  example: "北京"
                longitude:
                  type: string
                  description: 帖子发表时所在的经度
                  example: "116.4074"
                latitude:
                  type: string
                  description: 帖子发表时所在的纬度
                  example: "39.9042"
                images:
                  type: array
                  items:
                    type: string
                    description: 帖子照片列表，最多9张照片，每张照片为一个半截URL
                    example:
                      - "/uploads/xxx1.png"
                      - "/uploads/xxx2.png"
                visibility:
                  type: integer
                  enum:
                    - 0
                    - 1
                    - 2
                  description: 帖子可见性（非必填字段）:0=公开可见,1=主页可见,2=自己可见
                  example: 0
                  default: 0
                atUsers:
                  type: array
                  items:
                    type: string
                    description: 艾特的用户列表，与帖子文字内容共享一个字段
                    example:
                      - "user1"
                      - "user2"
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  postId:
                    type: string
                    description: 新增帖子ID
                    example: "123456"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/{postId}/heat:
    post:
      summary: 给帖子加热/取消加热
      tags:
        - 帖子
      parameters:
        - name: postId
          in: path
          required: true
          description: 帖子ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
        - name: action
          in: query
          required: true
          description: 加热操作，取值为1（加热）或0（取消加热）
          schema:
            type: integer
            enum: [ 1, 0 ]
            example: 1
      responses:
        200:
          description: 成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/{postId}/like:
    post:
      summary: 给帖子点赞/取消点赞
      tags:
        - 帖子
      parameters:
        - name: postId
          in: path
          required: true
          description: 帖子ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
        - name: action
          in: query
          required: true
          description: 点赞操作，取值为1（点赞）或0（取消点赞）
          schema:
            type: integer
            enum: [ 1, 0 ]
            example: 1
      responses:
        200:
          description: 成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/{userId}/follow:
    post:
      summary: 关注用户/取消关注
      tags:
        - 用户
      parameters:
        - name: userId
          in: path
          description: 被关注用户的ID
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
        - name: action
          in: query
          description: 关注操作，取值为1（关注）或0（取消关注）
          required: true
          schema:
            type: integer
            enum: [ 0, 1 ]
            example: 1
      responses:
        200:
          description: 成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/{postId}/comment:
    post:
      summary: 评论帖子/回复评论
      tags:
        - 帖子
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  description: 评论内容
                  example: "这是一条评论"
                parentId:
                  type: string
                  description: 父级评论ID(回复评论时必填)
                  example: "5dbf5fd3-2a3e-4b2a-b9ed-6c6e4f707a4f"
      parameters:
        - name: postId
          in: path
          required: true
          description: 帖子ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  commentId:
                    type: string
                    description: 新增评论的ID
                    example: "c1a1d3f2-4b2a-4e7a-b9ed-6c6e4f707a4f"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /comments/{commentId}:
    delete:
      summary: 删除评论
      tags:
        - 评论
      parameters:
        - name: commentId
          in: path
          required: true
          description: 评论ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/{postId}/collect:
    post:
      summary: 收藏/取消收藏帖子
      tags:
        - 帖子
      parameters:
        - name: postId
          in: path
          required: true
          description: 帖子ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - operation
              properties:
                operation:
                  type: integer
                  enum: [ 1, 0 ]
                  description: 操作类型，1-收藏，0-取消收藏
                  example: 1
      responses:
        200:
          description: 成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/{postId}/share:
    post:
      summary: 分享帖子
      tags:
        - 帖子
      parameters:
        - name: postId
          in: path
          required: true
          description: 帖子ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - sharePlatform
              properties:
                sharePlatform:
                  type: integer
                  enum: [ 1, 2, 3 ]
                  description: 分享平台，1-微信，2-QQ，3-微博
                  example: 1
      responses:
        200:
          description: 成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /comments/{commentId}/like:
    post:
      summary: 评论点赞/取消点赞
      tags:
        - 评论
      parameters:
        - name: commentId
          in: path
          required: true
          description: 评论ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - operation
              properties:
                operation:
                  type: integer
                  enum: [ 1, 0 ]
                  description: 操作类型，1-点赞，0-取消点赞
                  example: 1
      responses:
        200:
          description: 成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/{postId}:
    get:
      summary: 获取帖子详情
      tags:
        - 帖子
      parameters:
        - name: postId
          in: path
          required: true
          description: 帖子ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - authorId
                  - authorAvatar
                  - createTime
                  - content
                  - postId
                properties:
                  authorId:
                    type: string
                    description: 作者用户ID
                    example: 6133a6e2f7dcb80021a7e28a
                  authorAvatar:
                    type: string
                    format: url
                    description: 作者用户头像
                    example: "/uploads/avatar.png"
                  authorName:
                    type: string
                    description: 作者用户名
                    example: "小明"
                  createTime:
                    type: integer
                    format: unix timestamp
                    description: 帖子创建时间
                    example: 1578518245
                  isFollowed:
                    type: integer
                    default: 0
                    description: 当前登录用户是否已关注作者:0=否,1=是
                  images:
                    type: array
                    maxItems: 9
                    items:
                      type: string
                      format: url
                      description: 帖子图片
                      example: "/uploads/image1.png"
                  content:
                    type: string
                    description: 帖子文字内容
                    example: "今天天气真好!"
                  city:
                    type: string
                    description: 帖子发布位置
                    example: "北京"
                  likeCount:
                    type: integer
                    default: 0
                    description: 点赞数
                    example: 10
                  commentCount:
                    type: integer
                    default: 0
                    description: 评论数
                    example: 20
                  shareCount:
                    type: integer
                    default: 0
                    description: 分享数
                    example: 5
                  postId:
                    type: string
                    description: 帖子ID
                    example: 6133a6e2f7dcb80021a7e28a
                  isLiked:
                    type: integer
                    default: 0
                    description: 当前登录用户是否已点赞:0=否,1=是
                  isCollected:
                    type: integer
                    default: 0
                    description: 当前登录用户是否已收藏:0=否,1=是
                  conversationId:
                    type: string
                    description: 聊天会话的ID
                    example: "6133a6e2f7dcb80021a7e28a"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /posts/{postId}/comments:
    get:
      summary: 获取帖子评论列表
      tags:
        - 帖子
      parameters:
        - name: postId
          in: path
          required: true
          description: 帖子ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            default: 1
            minimum: 1
            example: 1
        - name: pageSize
          in: query
          description: 每页数据量
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
            example: 10
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Comment'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /comments/{commentId}/replies:
    get:
      summary: 获取评论回复列表
      tags:
        - 评论
      parameters:
        - name: commentId
          in: path
          required: true
          description: 评论ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            default: 1
            minimum: 1
            example: 1
        - name: pageSize
          in: query
          description: 每页数据量
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
            example: 10
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Comment'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/me/posts:
    get:
      summary: 获取我的帖子列表
      tags:
        - 用户
      parameters:
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            default: 1
            minimum: 1
            example: 1
        - name: pageSize
          in: query
          description: 每页数据量
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
            example: 10
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - postId
                    - createTime
                    - content
                  properties:
                    postId:
                      type: string
                      description: 帖子唯一ID
                      example: 6133a6e2f7dcb80021a7e28a
                    createTime:
                      type: integer
                      format: unix timestamp
                      description: 帖子创建时间
                      example: 1578518245
                    content:
                      type: string
                      description: 帖子文字内容
                      example: 今天天气真好!
                    images:
                      type: array
                      maxItems: 9
                      items:
                        type: string
                        format: url
                        description: 图片URL
                        example: /uploads/image1.png
                    city:
                      type: string
                      format: city name
                      description: 帖子发布时用户所在城市名称
                      example: 北京
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/me/posts/{postId}:
    get:
      summary: 获取我的帖子详情
      description: 该接口允许登录用户获取自己发表的某篇帖子的详情。
      tags:
        - 用户
      parameters:
        - name: postId
          in: path
          required: true
          description: 帖子ID
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - createTime
                  - content
                  - postId
                properties:
                  createTime:
                    type: integer
                    format: unix timestamp
                    description: 帖子创建时间，UNIX时间戳格式，精确到秒
                    example: 1578518245
                  images:
                    type: array
                    maxItems: 9
                    items:
                      type: string
                      format: url
                      description: 帖子图片URL列表
                      example:
                        - /uploads/image1.png
                        - /uploads/image2.png
                  content:
                    type: string
                    description: 帖子文字内容
                    example: 今天天气真好!
                  city:
                    type: string
                    format: city name
                    description: 帖子发表时用户所在城市名称
                    example: 北京
                  likeCount:
                    type: integer
                    default: 0
                    description: 帖子获得的赞数
                    example: 10
                  commentCount:
                    type: integer
                    default: 0
                    description: 帖子获得的评论数
                    example: 20
                  shareCount:
                    type: integer
                    default: 0
                    description: 帖子被分享的次数
                    example: 5
                  postId:
                    type: string
                    description: 帖子唯一ID
                    example: 6133a6e2f7dcb80021a7e28a
                  isLiked:
                    type: integer
                    default: 0
                    description: 当前登录用户是否点赞，0-未点赞，1-已点赞
                    example: 1
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /uploadPost:
    post:
      summary: 上传帖子照片
      tags:
        - 资源
      security:
        - JWTAuth: [ upload ]
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - post
              properties:
                post:
                  type: string
                  format: binary
                  description: 帖子照片
            encoding:
              post:
                contentType: image/*
      responses:
        200:
          description: 上传成功
          content:
            application/json:
              schema:
                required:
                  - url
                properties:
                  url:
                    type: string
                    description: 照片URL
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /notifications/interaction:
    get:
      summary: 获取交互类通知列表
      tags:
        - 通知
      parameters:
        - name: page
          in: query
          description: 分页页码
          schema:
            type: integer
            default: 1
            minimum: 1
            example: 1
        - name: pageSize
          in: query
          description: 每页通知数量
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
            example: 10
      responses:
        200:
          description: 成功响应
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - notificationId
                    - userAvatar
                    - userId
                    - interactionType
                    - interactionTime
                    - postId
                  properties:
                    notificationId:
                      type: string
                      description: 通知的 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    userAvatar:
                      type: string
                      description: 其他用户的头像 URL
                      example: /order/xxx.png
                    userId:
                      type: string
                      description: 其他用户的 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    userName:
                      type: string
                      description: 其他用户的用户名
                      example: John Doe
                    interactionType:
                      type: integer
                      description: |
                        交互类型 (0: 给帖子点赞, 1: 评论帖子, 2: 分享帖子, 3: 收藏帖子, 4: 评论点赞, 5: 回复评论)
                      example: 0
                      enum:
                        - 0
                        - 1
                        - 2
                        - 3
                        - 4
                        - 5
                    interactionTime:
                      type: integer
                      description: 交互发生的时间 (精确到秒的 UNIX 时间戳)
                      example: 1629876543
                    postId:
                      type: string
                      description: 帖子唯一ID
                      example: 6133a6e2f7dcb80021a7e28a
                    postImage:
                      type: string
                      description: 相关帖子的照片列表中的第一张照片的 URL（可选）
                      example: /order/xxx.png
                    readStatus:
                      type: integer
                      description: |
                        通知的已读状态 (0: 未读, 1: 已读, 默认值: 0)
                      example: 0
                      enum:
                        - 0
                        - 1
                      default: 0
                    commentId:
                      type: string
                      description: 评论 ID
                      example: 6133a6e2f7dcb80021a7e28a
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /notifications/interaction/{notificationId}/read:
    patch:
      summary: 将指定交互类通知标记为已读
      tags:
        - 通知
      parameters:
        - name: notificationId
          in: path
          description: 通知的 ID
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 成功响应
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /notifications/status:
    get:
      summary: 获取状态类通知列表
      tags:
        - 通知
      parameters:
        - name: page
          in: query
          description: 分页页码
          schema:
            type: integer
            default: 1
            minimum: 1
            example: 1
        - name: pageSize
          in: query
          description: 每页通知数量
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
            example: 10
      responses:
        200:
          description: 成功响应
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - notificationId
                    - userAvatar
                    - userId
                    - statusType
                    - statusTime
                  properties:
                    notificationId:
                      type: string
                      description: 通知的 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    userAvatar:
                      type: string
                      description: 其他用户的头像 URL
                      example: /order/xxx.png
                    userId:
                      type: string
                      description: 其他用户的 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    userName:
                      type: string
                      description: 其他用户的用户名
                      example: John Doe
                    statusType:
                      type: integer
                      description: |
                        状态类型 (0: 关注, 1: 访问主页)
                      example: 0
                      enum:
                        - 0
                        - 1
                      default: 0
                    statusTime:
                      type: integer
                      description: 状态发生的时间 (精确到秒的 UNIX 时间戳)
                      example: 1629876543
                    readStatus:
                      type: integer
                      description: |
                        通知的已读状态 (0: 未读, 1: 已读, 默认值: 0)
                      example: 0
                      enum:
                        - 0
                        - 1
                      default: 0
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /notifications/status/{notificationId}/read:
    patch:
      summary: 将指定状态类通知标记为已读
      tags:
        - 通知
      parameters:
        - name: notificationId
          in: path
          description: 要标记为已读的通知 ID
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 成功响应
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /notifications/gift:
    get:
      summary: 获取礼物类通知列表
      tags:
        - 通知
      parameters:
        - name: page
          in: query
          description: 分页页码
          schema:
            type: integer
            default: 1
            minimum: 1
            example: 1
        - name: pageSize
          in: query
          description: 每页通知数量
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
            example: 10
      responses:
        200:
          description: 成功响应
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - notificationId
                    - userAvatar
                    - userId
                    - giftQuantity
                    - giftName
                    - giftTime
                  properties:
                    notificationId:
                      type: string
                      description: 通知的 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    userAvatar:
                      type: string
                      description: 其他用户的头像 URL
                      example: /order/xxx.png
                    userId:
                      type: string
                      description: 其他用户的 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    userName:
                      type: string
                      description: 其他用户的用户名
                      example: John Doe
                    giftQuantity:
                      type: integer
                      description: 礼物数量
                      example: 3
                    giftName:
                      type: string
                      description: 礼物名称
                      example: Flower Bouquet
                    giftTime:
                      type: integer
                      description: 送礼的时间 (精确到秒的 UNIX 时间戳)
                      example: 1629876543
                    readStatus:
                      type: integer
                      description: |
                        通知的已读状态 (0: 未读, 1: 已读, 默认值: 0)
                      example: 0
                      enum:
                        - 0
                        - 1
                      default: 0
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /notifications/gift/{notificationId}/read:
    patch:
      summary: 将指定礼物类通知标记为已读
      tags:
        - 通知
      parameters:
        - name: notificationId
          in: path
          description: 要标记为已读的通知 ID
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 成功响应
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /notifications/system:
    get:
      summary: 获取系统类通知列表
      tags:
        - 通知
      parameters:
        - name: page
          in: query
          description: 分页页码
          schema:
            type: integer
            default: 1
            minimum: 1
            example: 1
        - name: pageSize
          in: query
          description: 每页通知数量
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
            example: 10
      responses:
        200:
          description: 成功响应
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - notificationId
                    - notificationTitle
                    - notificationContent
                    - notificationTime
                  properties:
                    notificationId:
                      type: string
                      description: 通知的 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    notificationTitle:
                      type: string
                      description: 通知标题
                      example: 系统更新通知
                    notificationContent:
                      type: string
                      description: 通知内容
                      example: 新版本已发布，请更新应用以享受最新功能。
                    notificationTime:
                      type: integer
                      description: 通知发布时间 (精确到秒的 UNIX 时间戳)
                      example: 1629876543
                    readStatus:
                      type: integer
                      description: |
                        通知的已读状态 (0: 未读, 1: 已读, 默认值: 0)
                      example: 0
                      enum:
                        - 0
                        - 1
                      default: 0
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /notifications/system/{notificationId}/read:
    patch:
      summary: 将指定系统类通知标记为已读
      tags:
        - 通知
      parameters:
        - name: notificationId
          in: path
          description: 要标记为已读的通知 ID
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 成功响应
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/following:
    get:
      summary: 获取我关注的用户列表
      tags:
        - 用户
      description: 获取当前用户关注的用户列表，支持分页和模糊查询。
      parameters:
        - name: page
          in: query
          description: 分页页码，从1开始。
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: pageSize
          in: query
          description: 分页大小，默认每页10条。
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
            example: 10
        - name: keyword
          in: query
          description: 用户名关键词。
          required: false
          schema:
            type: string
      responses:
        200:
          description: 成功获取用户列表
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FollowUser'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/followers:
    get:
      summary: 获取关注我的用户列表
      tags:
        - 用户
      description: 获取关注当前用户的用户列表，支持分页和模糊查询。
      parameters:
        - name: page
          in: query
          description: 分页页码，从1开始。
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: pageSize
          in: query
          description: 分页大小，默认每页10条。
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
            example: 10
        - name: keyword
          in: query
          description: 用户名关键词。
          required: false
          schema:
            type: string
      responses:
        200:
          description: 成功获取用户列表
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FollowUser'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/friends:
    get:
      summary: 获取互相关注的用户列表
      tags:
        - 用户
      description: 获取当前用户和其互相关注的用户列表，支持分页和模糊查询。
      parameters:
        - name: page
          in: query
          description: 分页页码，从1开始。
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: pageSize
          in: query
          description: 分页大小，默认每页10条。
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
            example: 10
        - name: keyword
          in: query
          description: 用户名关键词。
          required: false
          schema:
            type: string
      responses:
        200:
          description: 成功获取用户列表
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FollowUser'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/checkin/check:
    post:
      summary: 执行签到
      tags:
        - 用户
      responses:
        200:
          description: 成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - checkedDays
                properties:
                  checkedDays:
                    type: integer
                    format: int32
                    minimum: 0
                    maximum: 7
                    description: 连续签到的天数
                    example: 4
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/profile:
    patch:
      summary: 修改用户资料
      tags:
        - 用户
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                avatar:
                  type: string
                  description: 新的头像 URL
                  example: "/order/xxx.png"
                username:
                  type: string
                  description: 新的用户名
                  example: "John Doe"
                  minLength: 1
                  maxLength: 30
                city:
                  type: string
                  description: 新的所在城市名称
                  example: "New York"
                  maxLength: 50
                longitude:
                  type: string
                  format: float
                  description: 经度
                latitude:
                  type: string
                  format: float
                  description: 纬度
      responses:
        200:
          description: 用户资料修改成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/{userId}:
    get:
      summary: 获取用户详情
      tags:
        - 用户
      parameters:
        - name: userId
          in: path
          description: 用户 ID
          required: true
          schema:
            type: string
          example: 6133a6e2f7dcb80021a7e28a
      responses:
        200:
          description: 用户详情获取成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - avatar
                properties:
                  avatar:
                    type: string
                    description: 头像 URL
                    example: "/order/xxx.png"
                  username:
                    type: string
                    description: 用户名
                    example: "John Doe"
                    minLength: 1
                    maxLength: 30
                  city:
                    type: string
                    description: 所在城市名称
                    example: "New York"
                    maxLength: 50
                  followingCount:
                    type: integer
                    description: 关注用户数量
                    example: 10
                    default: 0
                  followersCount:
                    type: integer
                    description: 关注 ta 的用户数量
                    example: 20
                    default: 0
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /gifts:
    get:
      summary: 获取礼物列表
      tags:
        - 礼物
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: 页码
        - in: query
          name: pageSize
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: 每页大小
      responses:
        200:
          description: 成功获取礼物列表
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required:
                    - id
                    - image
                    - name
                    - value
                  properties:
                    id:
                      type: string
                      description: 礼物 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    image:
                      type: string
                      description: 礼物图片 URL
                      example: "/order/gift001.png"
                    name:
                      type: string
                      description: 礼物名称
                      example: "热气球"
                      maxLength: 50
                    value:
                      type: integer
                      description: 礼物价值（金币数）
                      example: 100
                      minimum: 1
                      maximum: 10000
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /gifts/send:
    post:
      summary: 向指定用户赠送指定数量的指定礼物
      tags:
        - 礼物
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - receiverId
                - giftId
                - quantity
              properties:
                receiverId:
                  type: string
                  description: 接收礼物的用户 ID
                  example: 6133a6e2f7dcb80021a7e28a
                giftId:
                  type: string
                  description: 礼物 ID
                  example: 6133a6e2f7dcb80021a7e28a
                quantity:
                  type: integer
                  description: 赠送数量
                  example: 3
                  minimum: 1
                  maximum: 100
      responses:
        200:
          description: 成功赠送礼物
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /users/me/gifts/received:
    get:
      summary: 获取当前登录用户收礼的统计信息
      tags:
        - 用户
      parameters:
        - in: query
          name: range
          description: 时间范围，0 表示全部时间，1 表示近一周，2 表示近一个月
          required: false
          schema:
            type: integer
            enum: [ 0, 1, 2 ]
            example: 1
            default: 0
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: array
                description: 礼物数量和排名信息数组
                items:
                  type: object
                  required:
                    - userId
                    - count
                    - currentRanking
                    - diff
                    - avatar
                  properties:
                    userId:
                      type: string
                      description: 送礼者的用户 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    count:
                      type: integer
                      description: 送礼者在指定时间范围内送给当前用户的礼物数量
                      example: 10
                      minimum: 0
                      maximum: 1000
                    currentRanking:
                      type: integer
                      description: 送礼者在指定时间范围内送给当前用户的礼物排名，排名越高表示送的礼物越多
                      example: 1
                      minimum: 1
                    diff:
                      type: integer
                      description: 送礼者在指定时间范围内送给当前用户的礼物排名变化情况，正数表示排名上升，负数表示排名下降
                      example: 0
                    username:
                      type: string
                      description: 送礼者的用户名
                      example: "user1"
                      maxLength: 50
                    avatar:
                      type: string
                      description: 送礼者的头像 URL
                      example: "avatar1.jpg"
                      maxLength: 255
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /products/coins:
    get:
      summary: 获取金币商品列表
      tags:
        - 商品
      parameters:
        - in: query
          name: page
          description: 页码，从 1 开始，默认为 1
          required: false
          schema:
            type: integer
            minimum: 1
            example: 1
            default: 1
        - in: query
          name: pageSize
          description: 每页显示的记录数，默认为 10
          required: false
          schema:
            type: integer
            minimum: 1
            example: 10
            default: 10
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: array
                description: 金币商品列表
                items:
                  type: object
                  required:
                    - productId
                    - coins
                    - price
                    - currency
                  properties:
                    productId:
                      type: string
                      description: 商品 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    coins:
                      type: integer
                      description: 商品包含的金币数量
                      example: 1000
                      minimum: 1
                      maximum: 100000
                    originalPrice:
                      type: integer
                      description: 商品原价，单位是分
                      example: 1000
                      minimum: 1
                      maximum: 10000000
                    price:
                      type: integer
                      description: 商品现价，单位是分
                      example: 900
                      minimum: 1
                      maximum: 10000000
                    currency:
                      type: string
                      description: 商品价格使用的货币代码，例如 CNY、USD、EUR 等
                      example: "CNY"
                      maxLength: 10
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /products/coins/{productId}/buy:
    post:
      summary: 购买金币商品
      tags:
        - 商品
      parameters:
        - in: path
          name: productId
          description: 金币商品 ID
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                receipt:
                  type: string
                  description: 第三方支付服务回调的凭据
                  example: "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9..."
              required:
                - receipt
      responses:
        200:
          description: OK
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /transactions/coins:
    get:
      summary: 获取金币交易记录列表
      tags:
        - 交易记录
      parameters:
        - in: query
          name: page
          description: 页码，从 1 开始，默认为 1
          required: false
          schema:
            type: integer
            minimum: 1
            example: 1
            default: 1
        - in: query
          name: pageSize
          description: 每页显示的记录数，默认为 10
          required: false
          schema:
            type: integer
            minimum: 1
            example: 10
            default: 10
        - in: query
          name: date
          description: 筛选指定日期的记录，格式为 YYYY-MM-DD，若不传则返回所有记录
          required: false
          schema:
            type: string
            format: date
            example: '2022-01-01'
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: array
                description: 交易记录列表
                items:
                  type: object
                  required:
                    - id
                    - createdAt
                    - currency
                    - amount
                  properties:
                    id:
                      type: string
                      description: 交易记录 ID
                      example: 6133a6e2f7dcb80021a7e28a
                    createdAt:
                      type: integer
                      format: int64
                      description: 交易记录的创建时间，精确到秒的 Unix 时间戳
                      example: 1662249209
                    currency:
                      type: string
                      description: 交易的货币类型
                      example: "USD"
                    amount:
                      type: number
                      format: float
                      description: 交易的金额
                      example: 0.99
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /socket.io:
    get:
      summary: 连接到 WebSocket
      responses:
        101:
          description: 切换协议
      tags:
        - WebSocket

  /notifications:
    post:
      summary: 服务端主动向客户端推送消息
      tags:
        - WebSocket
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - type
                - data
              properties:
                type:
                  type: integer
                  enum:
                    - 0
                    - 1
                    - 2
                    - 3
                    - 4
                    - 5
                    - 6
                    - 7
                    - 8
                    - 9
                    - 10
                    - 11
                    - 12
                  description: |
                    消息类型:
                      0表示距离最近用户列表
                      1表示在线用户总数
                      2表示未读通知总数
                      3表示创建的聊天会话对象
                      4表示最近的聊天会话列表
                      5表示聊天会话的详细信息
                      6表示最近的聊天消息列表
                      7表示发送的消息对象
                      8表示已标记为已读的消息对象
                      9表示创建的语音通话记录对象
                      10表示WebRTC的Offer信令
                      11表示WebRTC的Answer信令
                      12表示WebRTC的ICE Candidate信令
                  example: 0
                data:
                  type: object
                  description: 当type为10或11时，包含会话描述（SDP）信息，当type为12时，包含候选者信息
                  anyOf:
                    - $ref: '#/components/schemas/nearestUsers'
                    - $ref: '#/components/schemas/onlineUsers'
                    - $ref: '#/components/schemas/unreadNotificationsCount'
                    - $ref: '#/components/schemas/createdConversation'
                    - $ref: '#/components/schemas/recentConversations'
                    - $ref: '#/components/schemas/conversationDetails'
                    - $ref: '#/components/schemas/recentMessages'
                    - $ref: '#/components/schemas/sentMessage'
                    - $ref: '#/components/schemas/markedAsReadMessage'
                    - $ref: '#/components/schemas/voiceCall'
                    - $ref: '#/components/schemas/webrtcSdp'
                    - $ref: '#/components/schemas/webrtcCandidate'
      responses:
        200:
          description: 消息推送成功

  /messages:
    post:
      summary: 客户端主动向服务端推送消息
      tags:
        - WebSocket
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - type
                - data
              properties:
                type:
                  type: integer
                  enum:
                    - 0
                    - 1
                    - 2
                    - 3
                    - 4
                    - 5
                    - 6
                    - 7
                    - 8
                    - 9
                  description: |
                    消息类型:
                      0表示创建聊天会话
                      1表示获取最近的聊天会话列表
                      2表示获取聊天会话详情
                      3表示获取最近的聊天消息列表
                      4表示发送消息
                      5表示标记消息已读
                      6表示发起语音通话
                      7表示WebRTC的Offer信令
                      8表示WebRTC的Answer信令
                      9表示WebRTC的ICE Candidate信令
                  example: 3
                data:
                  type: object
                  anyOf:
                    - $ref: '#/components/schemas/createChatConversation'
                    - $ref: '#/components/schemas/getRecentChatConversations'
                    - $ref: '#/components/schemas/getChatConversationDetails'
                    - $ref: '#/components/schemas/getRecentChatMessages'
                    - $ref: '#/components/schemas/sendMessage'
                    - $ref: '#/components/schemas/markMessageAsRead'
                    - $ref: '#/components/schemas/initiateVoiceCall'
                    - $ref: '#/components/schemas/webrtcSdp'
                    - $ref: '#/components/schemas/webrtcCandidate'
      responses:
        200:
          description: 消息推送成功

  /uploadBundle:
    post:
      summary: 上传 Bundle 文件
      tags:
        - 资源
      security:
        - JWTAuth: [ upload ]
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - Bundle
              properties:
                bundle:
                  type: string
                  format: binary
                  description: Bundle 文件，以 MD5 作为文件名
            encoding:
              bundle:
                contentType: application/javascript
      responses:
        200:
          description: 上传成功
          content:
            application/json:
              schema:
                required:
                  - url
                properties:
                  url:
                    type: string
                    example: "test.bundle"
                    description: Bundle 文件 URL
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /bundles/publish:
    post:
      summary: 发布 Bundle
      tags:
        - Bundle
      security:
        - JWTAuth: [ publishBundle ]
      requestBody:
        content:
          application/json:
            schema:
              required:
                - url
                - version
              properties:
                url:
                  type: string
                  description: Bundle 文件的 URL
                  example: "test.bundle"
                version:
                  type: string
                  description: Bundle 的版本号
                  example: "1.0.0"
      responses:
        200:
          description: Bundle 发布成功
          content:
            application/json:
              schema:
                required:
                  - bundleId
                properties:
                  bundleId:
                    type: string
                    example: 6133a6e2f7dcb80021a7e28a
                    description: Bundle 的 ID
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/bundles/{bundleId}/online:
    post:
      summary: 上线 Bundle
      tags:
        - Bundle
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: path
          name: bundleId
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
          description: Bundle 的 ID
      responses:
        200:
          description: Bundle 上线成功
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /bundles/refresh:
    get:
      summary: Bundle 版本请求
      tags:
        - Bundle
      security:
        - JWTAuth: [ refreshBundle ]
      responses:
        200:
          description: 请求成功
          content:
            application/json:
              schema:
                required:
                  - url
                properties:
                  url:
                    type: string
                    example: "test.bundle"
                    description: Bundle 文件 URL
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /monitor/error:
    post:
      summary: 错误监控
      tags:
        - 监控
      security:
        - JWTAuth: [ monitor ]
      requestBody:
        content:
          application/json:
            schema:
              required:
                - projectName
                - errorMessage
                - stackTrace
              properties:
                projectName:
                  type: string
                  description: 项目名称
                errorMessage:
                  type: string
                  description: 错误消息
                stackTrace:
                  type: string
                  description: 堆栈跟踪
                appVersion:
                  type: string
                  description: 应用版本
                ipAddress:
                  type: string
                  description: IP地址
                runtimeName:
                  type: string
                  description: 运行时名称
                runtimeVersion:
                  type: string
                  description: 运行时版本
                appStartTime:
                  type: string
                  format: date-time
                  description: App启动时间
                appMemory:
                  type: number
                  description: App内存
                browserName:
                  type: string
                  description: 浏览器名称
                browserVersion:
                  type: string
                  description: 浏览器版本
                locale:
                  type: string
                  description: locale区域
                timezone:
                  type: string
                  description: 时区
                operatingSystemName:
                  type: string
                  description: 操作系统名称
                operatingSystemVersion:
                  type: string
                  description: 操作系统版本
                occurredFile:
                  type: string
                  description: 发生错误的文件名称
                occurredLine:
                  type: number
                  description: 发生错误的代码行
                occurredFunction:
                  type: string
                  description: 发生错误的函数名称
              example:
                projectName: MyProject
                errorMessage: An error occurred in the application.
                stackTrace: Error stack trace...
      responses:
        200:
          description: 错误日志已记录
        400:
          $ref: '#/components/responses/BadRequest'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/gifts:
    post:
      summary: 创建礼物
      tags:
        - 礼物
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - image
                - name
                - value
              properties:
                image:
                  type: string
                  description: 礼物图片 URL
                  example: "/order/gift001.png"
                name:
                  type: string
                  description: 礼物名称
                  example: "热气球"
                  maxLength: 50
                value:
                  type: integer
                  description: 礼物价值（金币数）
                  example: 100
                  minimum: 1
                  maximum: 10000
      responses:
        201:
          description: 礼物新增成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: 礼物 ID
                    example: 6133a6e2f7dcb80021a7e28a
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: 删除礼物
      tags:
        - 礼物
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: ids
          required: true
          schema:
            type: array
            items:
              type: string
            example: [ "6133a6e2f7dcb80021a7e28a", "6133a6e2f7dcb80021a7e28b" ]
          style: form
          explode: true
          description: 需要删除的礼物 ID 列表
      responses:
        204:
          description: 礼物删除成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    get:
      summary: 分页获取礼物列表
      tags:
        - 礼物
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: 页码
        - in: query
          name: pageSize
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: 每页大小
        - in: query
          name: keyword
          schema:
            type: string
          description: 关键词
        - in: query
          name: sort
          schema:
            type: string
            enum: [ name, value, createdAt, updatedAt ]
            default: updatedAt
          description: 排序字段
        - in: query
          name: order
          schema:
            type: string
            enum: [ asc, desc ]
            default: desc
          description: 排序方式
      responses:
        200:
          description: 成功获取礼物列表
          content:
            application/json:
              schema:
                type: object
                required:
                  - page
                  - pageSize
                  - total
                  - items
                properties:
                  page:
                    type: integer
                    description: 当前页码
                    example: 1
                    minimum: 1
                  pageSize:
                    type: integer
                    description: 每页大小
                    example: 10
                    minimum: 1
                    maximum: 100
                  total:
                    type: integer
                    description: 总记录数
                    example: 100
                    minimum: 0
                  items:
                    type: object
                    required:
                      - id
                      - image
                      - name
                      - value
                      - createdAt
                      - updatedAt
                    properties:
                      id:
                        type: string
                        description: 礼物 ID
                        example: 6133a6e2f7dcb80021a7e28a
                      image:
                        type: string
                        description: 礼物图片 URL
                        example: "/order/gift001.png"
                      name:
                        type: string
                        description: 礼物名称
                        example: "热气球"
                        maxLength: 50
                      value:
                        type: integer
                        description: 礼物价值（金币数）
                        example: 100
                        minimum: 1
                        maximum: 10000
                      createdAt:
                        type: string
                        format: date-time
                        description: 礼物创建时间
                        example: "2023-08-09T10:51:00.000Z"
                      updatedAt:
                        type: string
                        format: date-time
                        description: 礼物更新时间
                        example: "2023-08-09T10:52:00.000Z"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/gifts/{giftId}:
    put:
      summary: 修改礼物
      tags:
        - 礼物
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: path
          name: giftId
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
          description: 礼物的 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                image:
                  type: string
                  description: 礼物图片 URL
                  example: "/order/gift001.png"
                name:
                  type: string
                  description: 礼物名称
                  example: "热气球"
                  maxLength: 50
                value:
                  type: integer
                  description: 礼物价值（金币数）
                  example: 100
                  minimum: 1
                  maximum: 10000
      responses:
        200:
          description: 礼物修改成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/users:
    post:
      summary: 创建用户
      tags:
        - 用户
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - mobile
                - gender
                - birthday
                - avatar
              properties:
                mobile:
                  type: string
                  description: 用户手机号
                  example: "1234567890"
                gender:
                  type: string
                  description: 用户性别
                  example: "male"
                birthday:
                  type: string
                  format: date
                  description: 用户生日
                  example: "1990-01-01"
                avatar:
                  type: string
                  description: 用户头像 URL
                  example: "/avatars/user001.png"
                giftsReceived:
                  type: integer
                  description: 接收到的礼物数量
                  example: 5
                username:
                  type: string
                  description: 用户名
                  example: "JohnDoe"
                city:
                  type: string
                  description: 用户所在城市
                  example: "New York"
                followingCount:
                  type: integer
                  description: 关注的用户数量
                  example: 10
                followersCount:
                  type: integer
                  description: 粉丝数量
                  example: 20
                visitorsCount:
                  type: integer
                  description: 访客数量
                  example: 100
                freeHeatsLeft:
                  type: integer
                  description: 剩余免费热度次数
                  example: 2
                coinBalance:
                  type: integer
                  description: 金币余额
                  example: 500
                checkedDays:
                  type: integer
                  description: 连续签到的天数
                  example: 7
                lastCheckDate:
                  type: string
                  format: date-time
                  description: 上次签到日期
                  example: "2023-08-10T09:00:00Z"
                location:
                  type: object
                  properties:
                    type:
                      type: string
                      description: 地理位置类型
                      example: "Point"
                    coordinates:
                      type: array
                      items:
                        type: number
                      description: 地理坐标 [经度, 纬度]
                      example: [ -73.9857, 40.7484 ]
                following:
                  type: array
                  items:
                    type: string
                    format: uuid
                  description: 关注的用户列表
                receivedGiftRankings:
                  type: array
                  items:
                    type: object
                    properties:
                      userId:
                        type: string
                        format: uuid
                        description: 用户 ID
                      lastRanking:
                        type: integer
                        description: 上次排名
                  description: 接收到礼物的排行榜
                online:
                  type: integer
                  enum: [ 0, 1 ]
                  description: |
                    是否在线 (0: 否, 1: 是)
                  example: 1
      responses:
        201:
          description: 用户创建成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: 用户 ID
                    example: 6133a6e2f7dcb80021a7e28a
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: 删除用户
      tags:
        - 用户
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: ids
          required: true
          schema:
            type: array
            items:
              type: string
            example: [ "6133a6e2f7dcb80021a7e28a", "6133a6e2f7dcb80021a7e28b" ]
          style: form
          explode: true
          description: 需要删除的用户 ID 列表
      responses:
        204:
          description: 用户删除成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    get:
      summary: 分页获取用户列表
      tags:
        - 用户
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: 页码
        - in: query
          name: pageSize
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: 每页大小
        - in: query
          name: keyword
          schema:
            type: string
          description: 关键词
        - in: query
          name: sort
          schema:
            type: string
            enum: [ username, createdAt, updatedAt ]
            default: updatedAt
          description: 排序字段
        - in: query
          name: order
          schema:
            type: string
            enum: [ asc, desc ]
            default: desc
          description: 排序方式
      responses:
        200:
          description: 成功获取用户列表
          content:
            application/json:
              schema:
                type: object
                required:
                  - page
                  - pageSize
                  - total
                  - items
                properties:
                  page:
                    type: integer
                    description: 当前页码
                    example: 1
                    minimum: 1
                  pageSize:
                    type: integer
                    description: 每页大小
                    example: 10
                    minimum: 1
                    maximum: 100
                  total:
                    type: integer
                    description: 总记录数
                    example: 100
                    minimum: 0
                  items:
                    type: array
                    items:
                      type: object
                      required:
                        - id
                        - mobile
                        - gender
                        - birthday
                        - avatar
                      properties:
                        id:
                          type: string
                          description: 礼物 ID
                          example: 6133a6e2f7dcb80021a7e28a
                        mobile:
                          type: string
                          description: 用户手机号
                          example: "1234567890"
                        gender:
                          type: string
                          description: 用户性别
                          example: "male"
                        birthday:
                          type: string
                          format: date
                          description: 用户生日
                          example: "1990-01-01"
                        avatar:
                          type: string
                          description: 用户头像 URL
                          example: "/avatars/user001.png"
                        giftsReceived:
                          type: integer
                          description: 接收到的礼物数量
                          example: 5
                        username:
                          type: string
                          description: 用户名
                          example: "JohnDoe"
                        city:
                          type: string
                          description: 用户所在城市
                          example: "New York"
                        followingCount:
                          type: integer
                          description: 关注的用户数量
                          example: 10
                        followersCount:
                          type: integer
                          description: 粉丝数量
                          example: 20
                        visitorsCount:
                          type: integer
                          description: 访客数量
                          example: 100
                        freeHeatsLeft:
                          type: integer
                          description: 剩余免费热度次数
                          example: 2
                        coinBalance:
                          type: integer
                          description: 金币余额
                          example: 500
                        checkedDays:
                          type: integer
                          description: 连续签到的天数
                          example: 7
                        lastCheckDate:
                          type: string
                          format: date-time
                          description: 上次签到日期
                          example: "2023-08-10T09:00:00Z"
                        location:
                          type: object
                          properties:
                            type:
                              type: string
                              description: 地理位置类型
                              example: "Point"
                            coordinates:
                              type: array
                              items:
                                type: number
                              description: 地理坐标 [经度, 纬度]
                              example: [ -73.9857, 40.7484 ]
                        following:
                          type: array
                          items:
                            type: string
                            format: uuid
                          description: 关注的用户列表
                        createdAt:
                          type: string
                          format: date-time
                          description: 创建时间
                          example: "2023-08-01T12:00:00Z"
                        updatedAt:
                          type: string
                          format: date-time
                          description: 更新时间
                          example: "2023-08-10T09:30:00Z"
                        receivedGiftRankings:
                          type: array
                          items:
                            type: object
                            properties:
                              userId:
                                type: string
                                format: uuid
                                description: 用户 ID
                              lastRanking:
                                type: integer
                                description: 上次排名
                          description: 接收到礼物的排行榜
                        online:
                          type: integer
                          enum: [ 0, 1 ]
                          description: |
                            是否在线 (0: 否, 1: 是)
                          example: 1
                    description: 用户列表
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/users/{userId}:
    put:
      summary: 修改用户
      tags:
        - 用户
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
          description: 用户的 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - mobile
                - gender
                - birthday
                - avatar
              properties:
                mobile:
                  type: string
                  description: 用户手机号
                  example: "1234567890"
                gender:
                  type: string
                  description: 用户性别
                  example: "male"
                birthday:
                  type: string
                  format: date
                  description: 用户生日
                  example: "1990-01-01"
                avatar:
                  type: string
                  description: 用户头像 URL
                  example: "/avatars/user001.png"
                giftsReceived:
                  type: integer
                  description: 接收到的礼物数量
                  example: 5
                username:
                  type: string
                  description: 用户名
                  example: "JohnDoe"
                city:
                  type: string
                  description: 用户所在城市
                  example: "New York"
                followingCount:
                  type: integer
                  description: 关注的用户数量
                  example: 10
                followersCount:
                  type: integer
                  description: 粉丝数量
                  example: 20
                visitorsCount:
                  type: integer
                  description: 访客数量
                  example: 100
                freeHeatsLeft:
                  type: integer
                  description: 剩余免费热度次数
                  example: 2
                coinBalance:
                  type: integer
                  description: 金币余额
                  example: 500
                checkedDays:
                  type: integer
                  description: 连续签到的天数
                  example: 7
                lastCheckDate:
                  type: string
                  format: date-time
                  description: 上次签到日期
                  example: "2023-08-10T09:00:00Z"
                location:
                  type: object
                  properties:
                    type:
                      type: string
                      description: 地理位置类型
                      example: "Point"
                    coordinates:
                      type: array
                      items:
                        type: number
                      description: 地理坐标 [经度, 纬度]
                      example: [ -73.9857, 40.7484 ]
                following:
                  type: array
                  items:
                    type: string
                    format: uuid
                  description: 关注的用户列表
                receivedGiftRankings:
                  type: array
                  items:
                    type: object
                    properties:
                      userId:
                        type: string
                        format: uuid
                        description: 用户 ID
                      lastRanking:
                        type: integer
                        description: 上次排名
                  description: 接收到礼物的排行榜
                online:
                  type: integer
                  enum: [ 0, 1 ]
                  description: |
                    是否在线 (0: 否, 1: 是)
                  example: 1
      responses:
        200:
          description: 用户修改成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/giftHistories:
    post:
      summary: 创建礼物历史
      tags:
        - 礼物
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sender
                - receiver
                - gift
                - quantity
              properties:
                sender:
                  type: string
                  description: 发送者的唯一标识符
                  example: 60f372a9515b5f001f4b3a9e
                receiver:
                  type: string
                  description: 接收者的唯一标识符
                  example: 60f372a9515b5f001f4b3a9f
                gift:
                  type: string
                  description: 礼物的唯一标识符
                  example: 60f372a9515b5f001f4b3aa0
                quantity:
                  type: integer
                  description: 礼物的数量
                  example: 3
                  minimum: 1
      responses:
        201:
          description: 礼物历史创建成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: 礼物历史 ID
                    example: 6133a6e2f7dcb80021a7e28a
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: 删除礼物历史记录
      tags:
        - 礼物
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: ids
          required: true
          schema:
            type: array
            items:
              type: string
            example: [ "6133a6e2f7dcb80021a7e28a", "6133a6e2f7dcb80021a7e28b" ]
          style: form
          explode: true
          description: 需要删除的礼物历史记录 ID 列表
      responses:
        204:
          description: 礼物历史记录删除成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    get:
      summary: 分页获取礼物历史列表
      tags:
        - 礼物
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: 页码
        - in: query
          name: pageSize
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: 每页大小
        - in: query
          name: senderId
          schema:
            type: string
          description: 发送者ID
        - in: query
          name: receiverId
          schema:
            type: string
          description: 接收者ID
        - in: query
          name: sort
          schema:
            type: string
            enum: [ createdAt, updatedAt ]
            default: updatedAt
          description: 排序字段
        - in: query
          name: order
          schema:
            type: string
            enum: [ asc, desc ]
            default: desc
          description: 排序方式
      responses:
        200:
          description: 成功获取礼物历史列表
          content:
            application/json:
              schema:
                type: object
                required:
                  - page
                  - pageSize
                  - total
                  - items
                properties:
                  page:
                    type: integer
                    description: 当前页码
                    example: 1
                    minimum: 1
                  pageSize:
                    type: integer
                    description: 每页大小
                    example: 10
                    minimum: 1
                    maximum: 100
                  total:
                    type: integer
                    description: 总记录数
                    example: 100
                    minimum: 0
                  items:
                    type: array
                    items:
                      type: object
                      required:
                        - id
                        - sender
                        - receiver
                        - gift
                        - quantity
                        - createdAt
                        - updatedAt
                      properties:
                        id:
                          type: string
                          description: 礼物历史记录 ID
                          example: 6133a6e2f7dcb80021a7e28a
                        sender:
                          type: object
                          properties:
                            id:
                              type: string
                              description: 发送者 ID
                              example: 6133a6e2f7dcb80021a7e28b
                            username:
                              type: string
                              description: 发送者用户名
                              example: "JohnDoe"
                        receiver:
                          type: object
                          properties:
                            id:
                              type: string
                              description: 接收者 ID
                              example: 6133a6e2f7dcb80021a7e28c
                            username:
                              type: string
                              description: 接收者用户名
                              example: "JaneDoe"
                        gift:
                          type: object
                          properties:
                            id:
                              type: string
                              description: 礼物 ID
                              example: 6133a6e2f7dcb80021a7e28d
                            image:
                              type: string
                              description: 礼物图片 URL
                              example: "/order/gift001.png"
                            name:
                              type: string
                              description: 礼物名称
                              example: "热气球"
                              maxLength: 50
                            value:
                              type: integer
                              description: 礼物价值（金币数）
                              example: 100
                              minimum: 1
                              maximum: 10000
                        quantity:
                          type: integer
                          description: 礼物发送数量
                          example: 2
                          minimum: 1
                        createdAt:
                          type: string
                          format: date-time
                          description: 礼物历史记录创建时间
                          example: "2023-08-09T10:51:00.000Z"
                        updatedAt:
                          type: string
                          format: date-time
                          description: 礼物历史记录更新时间
                          example: "2023-08-09T10:52:00.000Z"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/giftHistories/{giftHistoryId}:
    put:
      summary: 修改礼物历史
      tags:
        - 礼物
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: path
          name: giftHistoryId
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
          description: 礼物历史的 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sender:
                  type: string
                  description: 发送者的 ID
                  example: 6133a6e2f7dcb80021a7e28a
                receiver:
                  type: string
                  description: 接收者的 ID
                  example: 6133a6e2f7dcb80021a7e28a
                gift:
                  type: string
                  description: 礼物的 ID
                  example: 6133a6e2f7dcb80021a7e28a
                quantity:
                  type: integer
                  description: 礼物数量
                  example: 2
                  minimum: 1
      responses:
        200:
          description: 礼物历史修改成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/verifications:
    post:
      summary: 创建验证码
      tags:
        - 验证码
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - mobile
                - code
              properties:
                mobile:
                  type: string
                  description: 手机号码
                  example: "1234567890"
                code:
                  type: string
                  description: 验证码
                  example: "1234"
      responses:
        201:
          description: 验证码创建成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: 验证码 ID
                    example: 6133a6e2f7dcb80021a7e28a
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: 删除验证码
      tags:
        - 验证码
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: ids
          required: true
          schema:
            type: array
            items:
              type: string
            example: [ "6133a6e2f7dcb80021a7e28a", "6133a6e2f7dcb80021a7e28b" ]
          style: form
          explode: true
          description: 需要删除的验证码 ID 列表
      responses:
        204:
          description: 验证码删除成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    get:
      summary: 分页获取验证码列表
      tags:
        - 验证码
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: 页码
        - in: query
          name: pageSize
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: 每页大小
        - in: query
          name: keyword
          schema:
            type: string
          description: 关键词
        - in: query
          name: sort
          schema:
            type: string
            enum: [ mobile, createdAt, updatedAt ]
            default: updatedAt
          description: 排序字段
        - in: query
          name: order
          schema:
            type: string
            enum: [ asc, desc ]
            default: desc
          description: 排序方式
      responses:
        200:
          description: 成功获取验证码列表
          content:
            application/json:
              schema:
                type: object
                required:
                  - page
                  - pageSize
                  - total
                  - items
                properties:
                  page:
                    type: integer
                    description: 当前页码
                    example: 1
                    minimum: 1
                  pageSize:
                    type: integer
                    description: 每页大小
                    example: 10
                    minimum: 1
                    maximum: 100
                  total:
                    type: integer
                    description: 总记录数
                    example: 100
                    minimum: 0
                  items:
                    type: array
                    description: 验证码列表
                    items:
                      type: object
                      required:
                        - id
                        - mobile
                        - code
                        - createdAt
                        - updatedAt
                      properties:
                        id:
                          type: string
                          description: 验证码 ID
                          example: 6133a6e2f7dcb80021a7e28a
                        mobile:
                          type: string
                          description: 手机号码
                          example: "1234567890"
                        code:
                          type: string
                          description: 验证码
                          example: "1234"
                        createdAt:
                          type: string
                          format: date-time
                          description: 验证码创建时间
                          example: "2023-08-09T10:51:00.000Z"
                        updatedAt:
                          type: string
                          format: date-time
                          description: 验证码更新时间
                          example: "2023-08-09T10:52:00.000Z"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/verifications/{verificationId}:
    put:
      summary: 修改验证码
      tags:
        - 验证码
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: path
          name: verificationId
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
          description: 验证码的 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: string
                  description: 验证码
                  example: "123456"
                mobile:
                  type: string
                  description: 手机号码
                  example: "1234567890"
              required:
                - code
                - mobile
      responses:
        200:
          description: 验证码修改成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/voiceCallRecords:
    post:
      summary: 创建语音通话记录
      tags:
        - 语音通话记录
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - callerId
                - recipientId
                - startTime
                - endTime
              properties:
                callerId:
                  type: string
                  description: 主叫用户的ID
                  example: 6133a6e2f7dcb80021a7e28a
                recipientId:
                  type: string
                  description: 被叫用户的ID
                  example: 6133a6e2f7dcb80021a7e28b
                startTime:
                  type: string
                  format: date-time
                  description: 通话开始时间
                  example: 2023-08-11T10:30:00Z
                endTime:
                  type: string
                  format: date-time
                  description: 通话结束时间
                  example: 2023-08-11T10:30:00Z
      responses:
        201:
          description: 语音通话记录创建成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: 语音通话记录的ID
                    example: 6133a6e2f7dcb80021a7e28c
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: 删除语音通话记录
      tags:
        - 语音通话记录
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: ids
          required: true
          schema:
            type: array
            items:
              type: string
            example: [ "6133a6e2f7dcb80021a7e28a", "6133a6e2f7dcb80021a7e28b" ]
          style: form
          explode: true
          description: 需要删除的语音通话记录 ID 列表
      responses:
        204:
          description: 语音通话记录删除成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    get:
      summary: 分页获取语音通话记录列表
      tags:
        - 语音通话记录
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: 页码
        - in: query
          name: pageSize
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: 每页大小
        - in: query
          name: callerId
          schema:
            type: string
          description: 主叫者ID
        - in: query
          name: recipientId
          schema:
            type: string
          description: 被叫者ID
        - in: query
          name: sort
          schema:
            type: string
            enum: [ startTime, endTime, createdAt, updatedAt ]
            default: updatedAt
          description: 排序字段
        - in: query
          name: order
          schema:
            type: string
            enum: [ asc, desc ]
            default: desc
          description: 排序方式
      responses:
        200:
          description: 成功获取语音通话记录列表
          content:
            application/json:
              schema:
                type: object
                required:
                  - page
                  - pageSize
                  - total
                  - items
                properties:
                  page:
                    type: integer
                    description: 当前页码
                    example: 1
                    minimum: 1
                  pageSize:
                    type: integer
                    description: 每页大小
                    example: 10
                    minimum: 1
                    maximum: 100
                  total:
                    type: integer
                    description: 总记录数
                    example: 100
                    minimum: 0
                  items:
                    type: array
                    items:
                      type: object
                      required:
                        - id
                        - caller
                        - recipient
                        - startTime
                        - endTime
                        - createdAt
                        - updatedAt
                      properties:
                        id:
                          type: string
                          description: 语音通话记录 ID
                          example: 6133a6e2f7dcb80021a7e28a
                        caller:
                          type: object
                          properties:
                            id:
                              type: string
                              description: 主叫者 ID
                              example: 6133a6e2f7dcb80021a7e28b
                            username:
                              type: string
                              description: 主叫者用户名
                              example: "JohnDoe"
                        recipient:
                          type: object
                          properties:
                            id:
                              type: string
                              description: 被叫者 ID
                              example: 6133a6e2f7dcb80021a7e28c
                            username:
                              type: string
                              description: 被叫者用户名
                              example: "JaneDoe"
                        startTime:
                          type: string
                          format: date-time
                          description: 通话开始时间
                          example: "2023-08-09T10:51:00.000Z"
                        endTime:
                          type: string
                          format: date-time
                          description: 通话结束时间
                          example: "2023-08-09T10:52:00.000Z"
                        createdAt:
                          type: string
                          format: date-time
                          description: 语音通话记录创建时间
                          example: "2023-08-09T10:51:00.000Z"
                        updatedAt:
                          type: string
                          format: date-time
                          description: 语音通话记录更新时间
                          example: "2023-08-09T10:52:00.000Z"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/voiceCallRecords/{voiceCallRecordId}:
    put:
      summary: 修改语音通话记录
      tags:
        - 语音通话记录
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: path
          name: voiceCallRecordId
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
          description: 语音通话记录的 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                callerId:
                  type: string
                  description: 发起者的 ID
                  example: 6133a6e2f7dcb80021a7e28a
                recipientId:
                  type: string
                  description: 接收者的 ID
                  example: 6133a6e2f7dcb80021a7e28a
                startTime:
                  type: string
                  format: date-time
                  description: 通话开始时间
                  example: "2023-08-11T10:00:00Z"
                endTime:
                  type: string
                  format: date-time
                  description: 通话结束时间
                  example: "2023-08-11T10:30:00Z"
              required:
                - callerId
                - recipientId
                - startTime
      responses:
        200:
          description: 语音通话记录修改成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/chatConversations:
    post:
      summary: 创建聊天会话
      tags:
        - 聊天会话
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId1
                - userId2
              properties:
                userId1:
                  type: string
                  description: 用户1的ID
                  example: 6133a6e2f7dcb80021a7e28a
                userId2:
                  type: string
                  description: 用户2的ID
                  example: 6133a6e2f7dcb80021a7e28b
                lastMessageTime:
                  type: string
                  format: date-time
                  description: 最后一条消息的时间
                  example: 2023-08-11T10:30:00Z
                lastMessageContent:
                  type: string
                  description: 最后一条消息的内容
                  example: Hello, how are you?
              example:
                userId1: 6133a6e2f7dcb80021a7e28a
                userId2: 6133a6e2f7dcb80021a7e28b
                lastMessageTime: 2023-08-11T10:30:00Z
                lastMessageContent: Hello, how are you?
      responses:
        201:
          description: 聊天会话创建成功
          content:
            application/json:
              schema:
                type: object
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: 聊天会话的ID
                    example: 6133a6e2f7dcb80021a7e28c
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: 删除聊天会话
      tags:
        - 聊天会话
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: ids
          required: true
          schema:
            type: array
            items:
              type: string
            example: [ "6133a6e2f7dcb80021a7e28a", "6133a6e2f7dcb80021a7e28b" ]
          style: form
          explode: true
          description: 需要删除的聊天会话 ID 列表
      responses:
        204:
          description: 聊天会话删除成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

    get:
      summary: 分页获取聊天会话列表
      tags:
        - 聊天会话
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: 页码
        - in: query
          name: pageSize
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: 每页大小
        - in: query
          name: userId1
          schema:
            type: string
          description: 用户1 ID
        - in: query
          name: userId2
          schema:
            type: string
          description: 用户2 ID
        - in: query
          name: sort
          schema:
            type: string
            enum: [ lastMessageTime, createdAt, updatedAt ]
            default: updatedAt
          description: 排序字段
        - in: query
          name: order
          schema:
            type: string
            enum: [ asc, desc ]
            default: desc
          description: 排序方式
      responses:
        200:
          description: 成功获取聊天会话列表
          content:
            application/json:
              schema:
                type: object
                required:
                  - page
                  - pageSize
                  - total
                  - items
                properties:
                  page:
                    type: integer
                    description: 当前页码
                    example: 1
                    minimum: 1
                  pageSize:
                    type: integer
                    description: 每页大小
                    example: 10
                    minimum: 1
                    maximum: 100
                  total:
                    type: integer
                    description: 总记录数
                    example: 100
                    minimum: 0
                  items:
                    type: array
                    items:
                      type: object
                      required:
                        - id
                        - userId1
                        - userId2
                        - createdAt
                        - updatedAt
                      properties:
                        id:
                          type: string
                          description: 聊天会话 ID
                          example: 6133a6e2f7dcb80021a7e28a
                        user1:
                          type: object
                          description: 用户1信息
                          required:
                            - id
                          properties:
                            id:
                              type: string
                              description: 用户1 ID
                              example: 6133a6e2f7dcb80021a7e28b
                            username:
                              type: string
                              description: 用户1用户名
                              example: "JohnDoe"
                        user2:
                          type: object
                          description: 用户2信息
                          required:
                            - id
                          properties:
                            id:
                              type: string
                              description: 用户2 ID
                              example: 6133a6e2f7dcb80021a7e28c
                            username:
                              type: string
                              description: 用户2用户名
                              example: "JaneDoe"
                        lastMessageTime:
                          type: string
                          format: date-time
                          description: 最后一条消息时间
                          example: "2023-08-09T10:51:00.000Z"
                        lastMessageContent:
                          type: string
                          description: 最后一条消息内容
                          example: "你好，今天天气真好！"
                        createdAt:
                          type: string
                          format: date-time
                          description: 聊天会话创建时间
                          example: "2023-08-09T10:51:00.000Z"
                        updatedAt:
                          type: string
                          format: date-time
                          description: 聊天会话更新时间
                          example: "2023-08-09T10:52:00.000Z"
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'

  /admin/chatConversations/{conversationId}:
    put:
      summary: 修改聊天会话
      tags:
        - 聊天会话
        - 后台管理
      security:
        - JWTAuth: [ admin ]
      parameters:
        - in: path
          name: conversationId
          required: true
          schema:
            type: string
            example: 6133a6e2f7dcb80021a7e28a
          description: 聊天会话的 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId1:
                  type: string
                  description: 用户1的 ID
                  example: 6133a6e2f7dcb80021a7e28a
                userId2:
                  type: string
                  description: 用户2的 ID
                  example: 6133a6e2f7dcb80021a7e28a
                lastMessageTime:
                  type: string
                  format: date-time
                  description: 最后一条消息的时间
                  example: "2023-08-14T12:30:00Z"
                lastMessageContent:
                  type: string
                  description: 最后一条消息的内容
                  example: "你好，今天天气真好！"
              required:
                - userId1
                - userId2
      responses:
        200:
          description: 聊天会话修改成功
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        429:
          $ref: '#/components/responses/TooManyRequests'
        500:
          $ref: '#/components/responses/InternalServerError'
components:
  responses:
    Unauthorized:
      description: 未授权
      content:
        application/json:
          schema:
            required:
              - message
            properties:
              message:
                type: string
                description: 错误信息

    BadRequest:
      description: 错误的请求
      content:
        application/json:
          schema:
            required:
              - message
            properties:
              message:
                type: string
                description: 错误信息

    Forbidden:
      description: 禁止访问
      content:
        application/json:
          schema:
            required:
              - message
            properties:
              message:
                type: string
                description: 错误信息

    NotFound:
      description: 找不到页面
      content:
        application/json:
          schema:
            required:
              - message
            properties:
              message:
                type: string
                description: 错误信息

    InternalServerError:
      description: 内部服务器错误
      content:
        application/json:
          schema:
            required:
              - message
            properties:
              message:
                type: string
                description: 错误信息

    TooManyRequests:
      description: 在一定的时间内用户发送了太多的请求，即超出了“频次限制”
      headers:
        Retry-After:
          description: 指示用户需要等待多长时间之后再发送新的请求
          schema:
            type: integer
            format: int32
      content:
        application/json:
          schema:
            required:
              - message
            properties:
              message:
                type: string
                description: 错误信息
  schemas:
    Comment:
      type: object
      required:
        - userId
        - avatar
        - createTime
        - content
        - commentId
      properties:
        userId:
          type: string
          description: 用户ID
          example: 6133a6e2f7dcb80021a7e28a
        avatar:
          type: string
          format: url
          description: 用户头像
          example: /uploads/avatar.png
        username:
          type: string
          description: 用户名
          example: 小明
        createTime:
          type: integer
          format: unix timestamp
          description: 评论创建时间
          example: 1578518245
        content:
          type: string
          description: 评论内容
          example: 这个帖子真好看!
        commentId:
          type: string
          description: 评论ID
          example: 6133a6e2f7dcb80021a7e28a
    FollowUser:
      type: array
      description: 用户列表
      items:
        type: object
        required:
          - userId
          - userAvatar
        properties:
          userId:
            type: string
            description: 用户id
            example: "612f8c4b241cd1002208d7c8"
          userAvatar:
            type: string
            description: 用户头像url，形如/order/xxx.png
            example: "/order/123.png"
          username:
            type: string
            description: 用户名
            example: "张三"
          latestPostContent:
            type: string
            description: 用户最新的帖子文字内容，最多100个字符，多出的字符用省略号代替
            example: "这是一条最新的帖子内容"
          conversationId:
            type: string
            description: 聊天会话的ID
            example: "6133a6e2f7dcb80021a7e28a"
    nearestUsers:
      type: object
      properties:
        users:
          type: array
          description: 最近的5位用户信息
          items:
            type: object
            required:
              - userId
              - avatarUrl
            properties:
              userId:
                type: string
                description: 用户 ID
                example: 6133a6e2f7dcb80021a7e28a
              avatarUrl:
                type: string
                description: 用户头像 URL
                example: "/order/xxx.png"
              username:
                type: string
                description: 用户名
                example: "张三"
              distance:
                type: number
                description: 距离当前用户的距离，以公里为单位
                example: 1.23
                minimum: 0
    onlineUsers:
      type: object
      properties:
        online:
          type: integer
          description: 当前系统在线总人数
          example: 12345
          minimum: 0
    unreadNotificationsCount:
      type: object
      properties:
        count:
          type: integer
          description: 未读通知总数
          example: 5
          minimum: 0
    createChatConversation:
      type: object
      required:
        - opponentUserId
      properties:
        opponentUserId:
          type: string
          description: 对方用户ID
          example: "12345"
    getRecentChatConversations:
      type: object
      properties:
        timestamp:
          type: integer
          description: 会话时间戳，精确到秒的 UNIX 时间戳
          example: 1628208000
    getChatConversationDetails:
      type: object
      required:
        - conversationId
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "abc123"
    getRecentChatMessages:
      type: object
      required:
        - conversationId
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "abc123"
        timestamp:
          type: integer
          description: 消息时间戳，精确到秒的 UNIX 时间戳
          example: 1628208000
    sendMessage:
      type: object
      required:
        - conversationId
        - opponentUserId
        - content
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "abc123"
        opponentUserId:
          type: string
          description: 对方用户ID
          example: "12345"
        content:
          type: string
          description: 消息的内容
          example: "Hello, how are you?"
    markMessageAsRead:
      type: object
      required:
        - conversationId
        - messageId
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "abc123"
        messageId:
          type: string
          description: 消息的ID
          example: "xyz789"
    initiateVoiceCall:
      type: object
      required:
        - conversationId
        - opponentUserId
        - startTime
        - endTime
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "abc123"
        opponentUserId:
          type: string
          description: 对方用户ID
          example: "12345"
        startTime:
          type: integer
          description: 通话开始时间，精确到秒的 UNIX 时间戳
          example: 1662028800
        endTime:
          type: integer
          description: 通话结束时间，精确到秒的 UNIX 时间戳
          example: 1662028900
    createdConversation:
      type: object
      required:
        - conversationId
        - opponentUserId
        - opponentAvatar
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "123456"
        opponentUserId:
          type: string
          description: 对方用户ID
          example: "12345"
        opponentAvatar:
          type: string
          description: 对方用户头像的URL，形如/xxx/xxx.png
          example: "/avatars/user1.png"
        opponentUsername:
          type: string
          description: 对方用户名
          example: "Alice"
        opponentOnlineStatus:
          type: integer
          description: 对方用户的在线状态，0表示离线，1表示在线
          example: 1
          default: 0
        opponentDistance:
          type: number
          description: 对方用户距离当前用户的距离（以公里为单位）
          example: 2.5
    recentConversations:
      type: array
      items:
        type: object
        required:
          - conversationId
          - opponentUserId
          - opponentAvatar
          - lastMessageTime
          - lastMessageContent
        properties:
          conversationId:
            type: string
            description: 聊天会话的ID
            example: "123456"
          opponentUserId:
            type: string
            description: 对方用户ID
            example: "user1"
          opponentAvatar:
            type: string
            description: 对方用户头像的URL，形如/xxx/xxx.png
            example: "/avatars/user1.png"
          opponentUsername:
            type: string
            description: 对方用户名
            example: "Alice"
          opponentOnlineStatus:
            type: integer
            description: 对方用户的在线状态，0表示离线，1表示在线
            example: 1
            default: 0
          opponentDistance:
            type: number
            description: 对方用户距离当前用户的距离（以公里为单位）
            example: 2.5
          lastMessageTime:
            type: integer
            description: 最后一条消息的发送时间，精确到秒的UNIX时间戳
            example: 1627862400
          lastMessageContent:
            type: string
            description: 最后一条消息的内容
            example: "你好，Alice！"
          unreadCount:
            type: integer
            description: 未读消息的数量
            example: 3
            default: 0
    conversationDetails:
      type: object
      required:
        - conversationId
        - opponentUserId
        - opponentAvatar
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "123456"
        opponentUserId:
          type: string
          description: 对方用户ID
          example: "user1"
        opponentAvatar:
          type: string
          description: 对方用户头像的URL，形如/xxx/xxx.png
          example: "/avatars/user1.png"
        opponentUsername:
          type: string
          description: 对方用户名
          example: "Alice"
        opponentOnlineStatus:
          type: integer
          description: 对方用户的在线状态，0表示离线，1表示在线
          example: 1
          default: 0
        opponentDistance:
          type: number
          description: 对方用户距离当前用户的距离（以公里为单位）
          example: 2.5
        lastMessageTime:
          type: integer
          description: 最后一条消息的发送时间，精确到秒的UNIX时间戳
          example: 1627862400
        lastMessageContent:
          type: string
          description: 最后一条消息的内容
          example: "你好，Alice！"
        unreadCount:
          type: integer
          description: 未读消息的数量
          example: 3
          default: 0
    recentMessages:
      type: array
      items:
        type: object
        required:
          - messageId
          - senderId
          - recipientId
          - sentTime
          - content
        properties:
          messageId:
            type: string
            description: 消息的ID
            example: "msg123"
          senderId:
            type: string
            description: 发送者用户ID
            example: "user1"
          recipientId:
            type: string
            description: 接受者用户ID
            example: "user1"
          sentTime:
            type: integer
            description: 消息发送的时间，精确到秒的UNIX时间戳
            example: 1627862400
          content:
            type: string
            description: 消息的内容
            example: "你好，Alice！"
          readStatus:
            type: integer
            enum:
              - 0
              - 1
            description: 消息的已读状态 (0表示未读, 1表示已读，默认值是0)
            example: 1
            default: 0
    sentMessage:
      type: object
      required:
        - conversationId
        - messageId
        - senderId
        - recipientId
        - content
        - sentTime
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "123456"
        messageId:
          type: string
          description: 消息的ID
          example: "msg123"
        senderId:
          type: string
          description: 发送者用户ID
          example: "user1"
        recipientId:
          type: string
          description: 接受者用户ID
          example: "user1"
        content:
          type: string
          description: 消息的内容
          example: "Hello, how are you?"
        sentTime:
          type: integer
          description: 消息发送的时间，精确到秒的UNIX时间戳
          example: 1627862400
        readStatus:
          type: integer
          enum:
            - 0
            - 1
          description: 消息的已读状态 (0表示未读, 1表示已读，默认值是0)
          example: 1
          default: 0
    markedAsReadMessage:
      type: object
      required:
        - conversationId
        - messageId
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "123456"
        messageId:
          type: string
          description: 消息的ID
          example: "msg123"
        readStatus:
          type: integer
          enum:
            - 0
            - 1
          description: 消息的已读状态 (0表示未读, 1表示已读，默认值是0)
          example: 1
          default: 0
    voiceCall:
      type: object
      required:
        - conversationId
        - messageId
        - senderId
        - recipientId
        - voiceCallRecordId
        - startTime
        - endTime
      properties:
        conversationId:
          type: string
          description: 聊天会话的ID
          example: "123456"
        messageId:
          type: string
          description: 消息的ID
          example: "msg123"
        senderId:
          type: string
          description: 发送者用户ID
          example: "user1"
        recipientId:
          type: string
          description: 接受者用户ID
          example: "user1"
        voiceCallRecordId:
          type: string
          description: 通话记录的ID
          example: "call123"
        startTime:
          type: integer
          description: 通话开始时间，精确到秒的 UNIX 时间戳
          example: 1662028800
        endTime:
          type: integer
          description: 通话结束时间，精确到秒的 UNIX 时间戳
          example: 1662028900
        readStatus:
          type: integer
          enum:
            - 0
            - 1
          description: 消息的已读状态 (0表示未读, 1表示已读，默认值是0)
          example: 1
          default: 0
    webrtcSdp:
      type: object
      description: WebRTC 会话描述（SDP）
      required:
        - opponentUserId
        - sdp
      properties:
        opponentUserId:
          type: string
          description: 对方用户ID
          example: "user1"
        sdp:
          type: string
          description: WebRTC会话描述（SDP）
          example: "v=0..."
    webrtcCandidate:
      type: object
      description: WebRTC ICE候选者信息
      required:
        - opponentUserId
        - candidate
        - sdpMLineIndex
        - sdpMid
      properties:
        opponentUserId:
          type: string
          description: 对方用户ID
          example: "user1"
        candidate:
          type: string
          description: 候选者信息字符串
          example: "candidate:1234567890..."
        sdpMLineIndex:
          type: integer
          description: ICE候选者的SDP媒体行索引
          example: 0
        sdpMid:
          type: string
          description: ICE候选者的SDP媒体行标识符
          example: "audio"
security:
  - JWTAuth: [ ]
